serviceMaps:
  serviceName: facility
  mappings:
    - version: 1.0
      description: Saves a facility
      fromTopic: save-facility-health-topic
      isTransaction: true
      isAuditEnabled: true
      module: FACILITY
      objecIdJsonPath: $.Facilities.*.id
      tenantIdJsonPath: $.Facilities.*.tenantId
      userUuidJsonPath: $.RequestInfo.userInfo.uuid
      transactionCodeJsonPath: $.Facilities.*.clientReferenceId
      auditAttributeBasePath: $.Facilities.*
      queryMaps:
        - query: INSERT INTO health.FACILITY(id, clientReferenceId, tenantId, isPermanent, name, usage, storageCapacity, addressId, additionalDetails, createdBy, createdTime, lastModifiedBy, lastModifiedTime, rowVersion, isDeleted) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);
          basePath: $.Facilities.*
          jsonMaps:
            - jsonPath: $.Facilities.*.id
            - jsonPath: $.Facilities.*.clientReferenceId
            - jsonPath: $.Facilities.*.tenantId
            - jsonPath: $.Facilities.*.isPermanent
            - jsonPath: $.Facilities.*.name
            - jsonPath: $.Facilities.*.usage
            - jsonPath: $.Facilities.*.storageCapacity
            - jsonPath: $.Facilities.*.address.id
            - jsonPath: $.Facilities.*.additionalFields
              type: JSON
              dbType: JSONB
            - jsonPath: $.Facilities.*.auditDetails.createdBy
            - jsonPath: $.Facilities.*.auditDetails.createdTime
            - jsonPath: $.Facilities.*.auditDetails.lastModifiedBy
            - jsonPath: $.Facilities.*.auditDetails.lastModifiedTime
            - jsonPath: $.Facilities.*.rowVersion
            - jsonPath: $.Facilities.*.isDeleted

        - query: INSERT INTO health.ADDRESS(id, tenantid, clientReferenceId, doorno, latitude, longitude, locationAccuracy, type, addressline1, addressline2, landmark, city, pincode, buildingName, street, localityCode) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.Facilities.*.address
          jsonMaps:
            - jsonPath: $.Facilities.*.address.id
            - jsonPath: $.Facilities.*.address.tenantId
            - jsonPath: $.Facilities.*.address.clientReferenceId
            - jsonPath: $.Facilities.*.address.doorNo
            - jsonPath: $.Facilities.*.address.latitude
            - jsonPath: $.Facilities.*.address.longitude
            - jsonPath: $.Facilities.*.address.locationAccuracy
            - jsonPath: $.Facilities.*.address.type
            - jsonPath: $.Facilities.*.address.addressLine1
            - jsonPath: $.Facilities.*.address.addressLine2
            - jsonPath: $.Facilities.*.address.landmark
            - jsonPath: $.Facilities.*.address.city
            - jsonPath: $.Facilities.*.address.pincode
            - jsonPath: $.Facilities.*.address.buildingName
            - jsonPath: $.Facilities.*.address.street
            - jsonPath: $.Facilities.*.address.locality.code

    - version: 1.0
      description: Updates a facility
      fromTopic: update-facility-health-topic
      isTransaction: true
      isAuditEnabled: true
      module: FACILITY
      objecIdJsonPath: $.Facilities.*.id
      tenantIdJsonPath: $.Facilities.*.tenantId
      userUuidJsonPath: $.RequestInfo.userInfo.uuid
      transactionCodeJsonPath: $.Facilities.*.clientReferenceId
      auditAttributeBasePath: $.Facilities.*
      queryMaps:
        - query: UPDATE health.FACILITY SET tenantId=?, clientReferenceId=?, isPermanent=?, name=?, usage=?, storageCapacity=?, addressId=?, additionalDetails=?, lastModifiedBy=?, lastModifiedTime=?, rowVersion=? WHERE id=? AND isDeleted=false;
          basePath: $.Facilities.*
          jsonMaps:
            - jsonPath: $.Facilities.*.tenantId
            - jsonPath: $.Facilities.*.clientReferenceId
            - jsonPath: $.Facilities.*.isPermanent
            - jsonPath: $.Facilities.*.name
            - jsonPath: $.Facilities.*.usage
            - jsonPath: $.Facilities.*.storageCapacity
            - jsonPath: $.Facilities.*.address.id
            - jsonPath: $.Facilities.*.additionalFields
              type: JSON
              dbType: JSONB
            - jsonPath: $.Facilities.*.auditDetails.lastModifiedBy
            - jsonPath: $.Facilities.*.auditDetails.lastModifiedTime
            - jsonPath: $.Facilities.*.rowVersion
            - jsonPath: $.Facilities.*.id

        - query: INSERT INTO health.ADDRESS(id, tenantid, clientReferenceId, doorno, latitude, longitude, locationAccuracy, type, addressline1, addressline2, landmark, city, pincode, buildingName, street, localityCode) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) ON CONFLICT(id) DO UPDATE SET tenantId = ?, clientReferenceId=?, doorno = ?, latitude = ?, longitude = ?, locationAccuracy = ?, type = ?, addressline1 = ?, addressline2 = ?, landmark = ?, city = ?, pincode = ?, buildingName = ?, street = ?, localityCode = ?;
          basePath: $.Facilities.*.address
          jsonMaps:
            - jsonPath: $.Facilities.*.address.id
            - jsonPath: $.Facilities.*.address.tenantId
            - jsonPath: $.Facilities.*.address.clientReferenceId
            - jsonPath: $.Facilities.*.address.doorNo
            - jsonPath: $.Facilities.*.address.latitude
            - jsonPath: $.Facilities.*.address.longitude
            - jsonPath: $.Facilities.*.address.locationAccuracy
            - jsonPath: $.Facilities.*.address.type
            - jsonPath: $.Facilities.*.address.addressLine1
            - jsonPath: $.Facilities.*.address.addressLine2
            - jsonPath: $.Facilities.*.address.landmark
            - jsonPath: $.Facilities.*.address.city
            - jsonPath: $.Facilities.*.address.pincode
            - jsonPath: $.Facilities.*.address.buildingName
            - jsonPath: $.Facilities.*.address.street
            - jsonPath: $.Facilities.*.address.locality.code
            - jsonPath: $.Facilities.*.address.tenantId
            - jsonPath: $.Facilities.*.address.clientReferenceId
            - jsonPath: $.Facilities.*.address.doorNo
            - jsonPath: $.Facilities.*.address.latitude
            - jsonPath: $.Facilities.*.address.longitude
            - jsonPath: $.Facilities.*.address.locationAccuracy
            - jsonPath: $.Facilities.*.address.type
            - jsonPath: $.Facilities.*.address.addressLine1
            - jsonPath: $.Facilities.*.address.addressLine2
            - jsonPath: $.Facilities.*.address.landmark
            - jsonPath: $.Facilities.*.address.city
            - jsonPath: $.Facilities.*.address.pincode
            - jsonPath: $.Facilities.*.address.buildingName
            - jsonPath: $.Facilities.*.address.street
            - jsonPath: $.Facilities.*.address.locality.code

    - version: 1.0
      description: Deletes a facility
      fromTopic: delete-facility-health-topic
      isTransaction: true
      isAuditEnabled: true
      module: FACILITY
      objecIdJsonPath: $.Facilities.*.id
      tenantIdJsonPath: $.Facilities.*.tenantId
      userUuidJsonPath: $.RequestInfo.userInfo.uuid
      transactionCodeJsonPath: $.Facilities.*.clientReferenceId
      auditAttributeBasePath: $.Facilities.*
      queryMaps:
        - query: UPDATE health.FACILITY SET lastModifiedBy=?, lastModifiedTime=?, rowVersion=?, isDeleted=?, additionalDetails=? WHERE id=?;
          basePath: $.Facilities.*
          jsonMaps:
            - jsonPath: $.Facilities.*.auditDetails.lastModifiedBy
            - jsonPath: $.Facilities.*.auditDetails.lastModifiedTime
            - jsonPath: $.Facilities.*.rowVersion
            - jsonPath: $.Facilities.*.isDeleted
            - jsonPath: $.Facilities.*.additionalFields
              type: JSON
              dbType: JSONB
            - jsonPath: $.Facilities.*.id