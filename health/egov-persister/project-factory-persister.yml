serviceMaps:
  serviceName: API Resource Service
  mappings:
    - version: 1.0
      name: CreateResourceDetails
      description: Create resource details in the eg_cm_resource_details table
      fromTopic: create-resource-details
      isTransaction: true
      queryMaps:
        - query: INSERT INTO eg_cm_resource_details(id, "status", tenantId, fileStoreId,processedFileStoreId,"action", "type", createdBy, createdTime, lastModifiedBy, lastModifiedTime, additionalDetails) VALUES (?, ?,?, ?,?, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.ResourceDetails
          jsonMaps:
            - jsonPath: $.ResourceDetails.id
            - jsonPath: $.ResourceDetails.status
            - jsonPath: $.ResourceDetails.tenantId
            - jsonPath: $.ResourceDetails.fileStoreId
            - jsonPath: $.ResourceDetails.processedFileStoreId
            - jsonPath: $.ResourceDetails.action
            - jsonPath: $.ResourceDetails.type
            - jsonPath: $.ResourceDetails.auditDetails.createdBy
            - jsonPath: $.ResourceDetails.auditDetails.createdTime
            - jsonPath: $.ResourceDetails.auditDetails.lastModifiedBy
            - jsonPath: $.ResourceDetails.auditDetails.lastModifiedTime
            - jsonPath: $.ResourceDetails.additionalDetails
              type: JSON
              dbType: JSONB

    - version: 1.0
      name: CreateResourceActivity
      description: Create resource activity in the eg_cm_resource_activity table
      fromTopic: create-resource-activity
      isTransaction: true
      queryMaps:
        - query: INSERT INTO eg_cm_resource_activity (id, "status", retryCount,tenantId, type, url, requestPayload, responsePayload, createdBy, createdTime, lastModifiedBy, lastModifiedTime, additionalDetails, resourceDetailsId) VALUES (?, ?,?, ?, ?,  ?, ?, ?, ?, ?, ?, ?, ?,?);
          basePath: $.Activities.*
          jsonMaps:
            - jsonPath: $.Activities.*.id
            - jsonPath: $.Activities.*.status
            - jsonPath: $.Activities.*.retryCount
            - jsonPath: $.Activities.*.tenantId
            - jsonPath: $.Activities.*.type
            - jsonPath: $.Activities.*.url
            - jsonPath: $.Activities.*.requestPayload
              type: JSON
              dbType: JSONB
            - jsonPath: $.Activities.*.responsePayload
              type: JSON
              dbType: JSONB
            - jsonPath: $.Activities.*.auditDetails.createdBy
            - jsonPath: $.Activities.*.auditDetails.createdTime
            - jsonPath: $.Activities.*.auditDetails.lastModifiedBy
            - jsonPath: $.Activities.*.auditDetails.lastModifiedTime
            - jsonPath: $.Activities.*.additionalDetails
              type: JSON
              dbType: JSONB
            - jsonPath: $.Activities.*.resourceDetailsId


    - version: 1.0
      name: CreateForGenerateApiResources
      description: Create Api resource in the eg_cm_generated_resource_details table
      fromTopic: create-generated-resource-details
      isTransaction: true
      queryMaps:
        - query: INSERT INTO eg_cm_generated_resource_details (id,filestoreid, type,"status",count,tenantid, createdby, createdtime, lastmodifiedby, lastmodifiedtime, additionaldetails) VALUES (?,?,?,?,?,?,?,?,?,?,?);
          basePath: generatedResource.*
          jsonMaps:
            - jsonPath: $.generatedResource.*.id
            - jsonPath: $.generatedResource.*.fileStoreid
            - jsonPath: $.generatedResource.*.type
            - jsonPath: $.generatedResource.*.status
            - jsonPath: $.generatedResource.*.count
            - jsonPath: $.generatedResource.*.tenantId
            - jsonPath: $.generatedResource.*.auditDetails.createdBy
            - jsonPath: $.generatedResource.*.auditDetails.createdTime
            - jsonPath: $.generatedResource.*.auditDetails.lastModifiedBy
            - jsonPath: $.generatedResource.*.auditDetails.lastModifiedTime
            - jsonPath: $.generatedResource.*.additionalDetails
              type: JSON
              dbType: JSONB




    - version: 1.0
      name: UpdateForGenerateApiResources
      description: Update Api resource in the eg_cm_generated_resource_details table
      fromTopic: update-generated-resource-details
      isTransaction: true
      queryMaps:
        - query: UPDATE eg_cm_generated_resource_details SET status = ?,count=?, lastModifiedby =? , lastModifiedtime = ? , fileStoreid= ? WHERE id= ?;
          basePath: generatedResource.*
          jsonMaps:
            - jsonPath: $.generatedResource.*.status
            - jsonPath: $.generatedResource.*.count
            - jsonPath: $.generatedResource.*.auditDetails.lastModifiedBy
            - jsonPath: $.generatedResource.*.auditDetails.lastModifiedTime
            - jsonPath: $.generatedResource.*.fileStoreid
            - jsonPath: $.generatedResource.*.id
