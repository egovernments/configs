serviceMaps:
  serviceName: household
  mappings:
    - version: 1.0
      description: Persists household.
      fromTopic: save-household-health-topic
      isTransaction: true
      isAuditEnabled: true
      module: HOUSEHOLD
      objecIdJsonPath: $.Households.*.id
      tenantIdJsonPath: $.Households.*.tenantId
      userUuidJsonPath: $.RequestInfo.userInfo.uuid
      transactionCodeJsonPath: $.Households.*.clientReferenceId
      auditAttributeBasePath: $.Households.*
      queryMaps:
        - query: INSERT INTO health.HOUSEHOLD(id, tenantId, clientReferenceId, numberOfMembers, addressId, additionalDetails, createdBy, lastModifiedBy, createdTime, lastModifiedTime, rowVersion, isDeleted, clientCreatedTime, clientLastModifiedTime, clientCreatedBy, clientLastModifiedBy) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.Households.*
          jsonMaps:
            - jsonPath: $.Households.*.id
            - jsonPath: $.Households.*.tenantId
            - jsonPath: $.Households.*.clientReferenceId
            - jsonPath: $.Households.*.memberCount
            - jsonPath: $.Households.*.address.id
            - jsonPath: $.Households.*.additionalFields
              type: JSON
              dbType: JSONB
            - jsonPath: $.Households.*.auditDetails.createdBy
            - jsonPath: $.Households.*.auditDetails.lastModifiedBy
            - jsonPath: $.Households.*.auditDetails.createdTime
            - jsonPath: $.Households.*.auditDetails.lastModifiedTime
            - jsonPath: $.Households.*.rowVersion
            - jsonPath: $.Households.*.isDeleted
            - jsonPath: $.Households.*.clientAuditDetails.createdTime
            - jsonPath: $.Households.*.clientAuditDetails.lastModifiedTime
            - jsonPath: $.Households.*.clientAuditDetails.createdBy
            - jsonPath: $.Households.*.clientAuditDetails.lastModifiedBy
        - query: INSERT INTO health.ADDRESS(id, clientReferenceId, tenantid, doorno, latitude, longitude, locationAccuracy, type, addressline1, addressline2, landmark, city, pincode, buildingName, street, localityCode) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.Households.*.address
          jsonMaps:
            - jsonPath: $.Households.*.address.id
            - jsonPath: $.Households.*.address.clientReferenceId
            - jsonPath: $.Households.*.address.tenantId
            - jsonPath: $.Households.*.address.doorNo
            - jsonPath: $.Households.*.address.latitude
            - jsonPath: $.Households.*.address.longitude
            - jsonPath: $.Households.*.address.locationAccuracy
            - jsonPath: $.Households.*.address.type
            - jsonPath: $.Households.*.address.addressLine1
            - jsonPath: $.Households.*.address.addressLine2
            - jsonPath: $.Households.*.address.landmark
            - jsonPath: $.Households.*.address.city
            - jsonPath: $.Households.*.address.pincode
            - jsonPath: $.Households.*.address.buildingName
            - jsonPath: $.Households.*.address.street
            - jsonPath: $.Households.*.address.locality.code

    - version: 1.0
      description: Updates household.
      fromTopic: update-household-health-topic
      isTransaction: true
      isAuditEnabled: true
      module: HOUSEHOLD
      objecIdJsonPath: $.Households.*.id
      tenantIdJsonPath: $.Households.*.tenantId
      userUuidJsonPath: $.RequestInfo.userInfo.uuid
      transactionCodeJsonPath: $.Households.*.clientReferenceId
      auditAttributeBasePath: $.Households.*
      queryMaps:
        - query: UPDATE health.HOUSEHOLD SET tenantId = ?, clientReferenceId = ?, numberOfMembers = ?, addressId = ?, additionalDetails = ?, lastModifiedBy = ?, lastModifiedTime = ?, rowVersion = ?, isDeleted = ?, clientLastModifiedTime = ?, clientLastModifiedBy = ? WHERE ID = ?;
          basePath: $.Households.*
          jsonMaps:
            - jsonPath: $.Households.*.tenantId
            - jsonPath: $.Households.*.clientReferenceId
            - jsonPath: $.Households.*.memberCount
            - jsonPath: $.Households.*.address.id
            - jsonPath: $.Households.*.additionalFields
              type: JSON
              dbType: JSONB
            - jsonPath: $.Households.*.auditDetails.lastModifiedBy
            - jsonPath: $.Households.*.auditDetails.lastModifiedTime
            - jsonPath: $.Households.*.rowVersion
            - jsonPath: $.Households.*.isDeleted
            - jsonPath: $.Households.*.clientAuditDetails.lastModifiedTime
            - jsonPath: $.Households.*.clientAuditDetails.lastModifiedBy
            - jsonPath: $.Households.*.id
        - query: INSERT INTO health.ADDRESS(id, clientReferenceId, tenantid, doorno, latitude, longitude, locationAccuracy, type, addressline1, addressline2, landmark, city, pincode, buildingName, street, localityCode) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) ON CONFLICT(id) DO UPDATE SET tenantId = ?, doorno = ?, latitude = ?, longitude = ?, locationAccuracy = ?, type = ?, addressline1 = ?, addressline2 = ?, landmark = ?, city = ?, pincode = ?, buildingName = ?, street = ?, localityCode = ?;
          basePath: $.Households.*.address
          jsonMaps:
            - jsonPath: $.Households.*.address.id
            - jsonPath: $.Households.*.address.clientReferenceId
            - jsonPath: $.Households.*.address.tenantId
            - jsonPath: $.Households.*.address.doorNo
            - jsonPath: $.Households.*.address.latitude
            - jsonPath: $.Households.*.address.longitude
            - jsonPath: $.Households.*.address.locationAccuracy
            - jsonPath: $.Households.*.address.type
            - jsonPath: $.Households.*.address.addressLine1
            - jsonPath: $.Households.*.address.addressLine2
            - jsonPath: $.Households.*.address.landmark
            - jsonPath: $.Households.*.address.city
            - jsonPath: $.Households.*.address.pincode
            - jsonPath: $.Households.*.address.buildingName
            - jsonPath: $.Households.*.address.street
            - jsonPath: $.Households.*.address.locality.code
            - jsonPath: $.Households.*.address.tenantId
            - jsonPath: $.Households.*.address.doorNo
            - jsonPath: $.Households.*.address.latitude
            - jsonPath: $.Households.*.address.longitude
            - jsonPath: $.Households.*.address.locationAccuracy
            - jsonPath: $.Households.*.address.type
            - jsonPath: $.Households.*.address.addressLine1
            - jsonPath: $.Households.*.address.addressLine2
            - jsonPath: $.Households.*.address.landmark
            - jsonPath: $.Households.*.address.city
            - jsonPath: $.Households.*.address.pincode
            - jsonPath: $.Households.*.address.buildingName
            - jsonPath: $.Households.*.address.street
            - jsonPath: $.Households.*.address.locality.code

    - version: 1.0
      description: Deletes household.
      fromTopic: delete-household-health-topic
      isTransaction: true
      isAuditEnabled: true
      module: HOUSEHOLD
      objecIdJsonPath: $.Households.*.id
      tenantIdJsonPath: $.Households.*.tenantId
      userUuidJsonPath: $.RequestInfo.userInfo.uuid
      transactionCodeJsonPath: $.Households.*.clientReferenceId
      auditAttributeBasePath: $.Households.*
      queryMaps:
        - query: UPDATE health.HOUSEHOLD SET lastModifiedBy = ?, lastModifiedTime = ?, clientLastModifiedTime = ?, clientLastModifiedBy = ?,  rowVersion = ?, isDeleted = ?, additionalDetails=? WHERE ID = ?;
          basePath: $.Households.*
          jsonMaps:
            - jsonPath: $.Households.*.auditDetails.lastModifiedBy
            - jsonPath: $.Households.*.auditDetails.lastModifiedTime
            - jsonPath: $.Households.*.clientAuditDetails.lastModifiedTime
            - jsonPath: $.Households.*.clientAuditDetails.lastModifiedBy
            - jsonPath: $.Households.*.rowVersion
            - jsonPath: $.Households.*.isDeleted
            - jsonPath: $.Households.*.additionalFields
              type: JSON
              dbType: JSONB
            - jsonPath: $.Households.*.id

    - version: 1.0
      description: Persists household member.
      fromTopic: save-household-member-health-topic
      isTransaction: true
      isAuditEnabled: true
      module: HOUSEHOLD
      objecIdJsonPath: $.HouseholdMembers.*.id
      tenantIdJsonPath: $.HouseholdMembers.*.tenantId
      userUuidJsonPath: $.RequestInfo.userInfo.uuid
      transactionCodeJsonPath: $.HouseholdMembers.*.clientReferenceId
      auditAttributeBasePath: $.HouseholdMembers.*
      queryMaps:
        - query: INSERT INTO health.HOUSEHOLD_MEMBER(id, tenantId, clientReferenceId, individualId, individualClientReferenceId, householdId, householdClientReferenceId, isHeadOfHousehold, additionalDetails, createdBy, lastModifiedBy, createdTime, lastModifiedTime, rowVersion, isDeleted, clientCreatedTime, clientLastModifiedTime, clientCreatedBy, clientLastModifiedBy) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
          basePath: $.HouseholdMembers.*
          jsonMaps:
            - jsonPath: $.HouseholdMembers.*.id
            - jsonPath: $.HouseholdMembers.*.tenantId
            - jsonPath: $.HouseholdMembers.*.clientReferenceId
            - jsonPath: $.HouseholdMembers.*.individualId
            - jsonPath: $.HouseholdMembers.*.individualClientReferenceId
            - jsonPath: $.HouseholdMembers.*.householdId
            - jsonPath: $.HouseholdMembers.*.householdClientReferenceId
            - jsonPath: $.HouseholdMembers.*.isHeadOfHousehold
            - jsonPath: $.HouseholdMembers.*.additionalFields
              type: JSON
              dbType: JSONB
            - jsonPath: $.HouseholdMembers.*.auditDetails.createdBy
            - jsonPath: $.HouseholdMembers.*.auditDetails.lastModifiedBy
            - jsonPath: $.HouseholdMembers.*.auditDetails.createdTime
            - jsonPath: $.HouseholdMembers.*.auditDetails.lastModifiedTime
            - jsonPath: $.HouseholdMembers.*.rowVersion
            - jsonPath: $.HouseholdMembers.*.isDeleted
            - jsonPath: $.HouseholdMembers.*.clientAuditDetails.createdTime
            - jsonPath: $.HouseholdMembers.*.clientAuditDetails.lastModifiedTime
            - jsonPath: $.HouseholdMembers.*.clientAuditDetails.createdBy
            - jsonPath: $.HouseholdMembers.*.clientAuditDetails.lastModifiedBy
    - version: 1.0
      description: Update household member.
      fromTopic: update-household-member-health-topic
      isTransaction: true
      isAuditEnabled: true
      module: HOUSEHOLD
      objecIdJsonPath: $.HouseholdMembers.*.id
      tenantIdJsonPath: $.HouseholdMembers.*.tenantId
      userUuidJsonPath: $.RequestInfo.userInfo.uuid
      transactionCodeJsonPath: $.HouseholdMembers.*.clientReferenceId
      auditAttributeBasePath: $.HouseholdMembers.*
      queryMaps:
        - query: UPDATE health.HOUSEHOLD_MEMBER SET isHeadOfHousehold=?, clientReferenceId = ?, additionalDetails=?, lastModifiedBy=?, lastModifiedTime=?, rowVersion=?, isDeleted=?, clientLastModifiedTime = ?, clientLastModifiedBy = ? WHERE individualId=? AND householdId=? AND isDeleted=false;
          basePath: $.HouseholdMembers.*
          jsonMaps:
            - jsonPath: $.HouseholdMembers.*.isHeadOfHousehold
            - jsonPath: $.HouseholdMembers.*.clientReferenceId
            - jsonPath: $.HouseholdMembers.*.additionalFields
              type: JSON
              dbType: JSONB
            - jsonPath: $.HouseholdMembers.*.auditDetails.lastModifiedBy
            - jsonPath: $.HouseholdMembers.*.auditDetails.lastModifiedTime
            - jsonPath: $.HouseholdMembers.*.rowVersion
            - jsonPath: $.HouseholdMembers.*.isDeleted
            - jsonPath: $.HouseholdMembers.*.clientAuditDetails.lastModifiedTime
            - jsonPath: $.HouseholdMembers.*.clientAuditDetails.lastModifiedBy
            - jsonPath: $.HouseholdMembers.*.individualId
            - jsonPath: $.HouseholdMembers.*.householdId
    - version: 1.0
      description: Deletes household Member.
      fromTopic: delete-household-member-health-topic
      isTransaction: true
      isAuditEnabled: true
      module: HOUSEHOLD
      objecIdJsonPath: $.HouseholdMembers.*.id
      tenantIdJsonPath: $.HouseholdMembers.*.tenantId
      userUuidJsonPath: $.RequestInfo.userInfo.uuid
      transactionCodeJsonPath: $.HouseholdMembers.*.clientReferenceId
      auditAttributeBasePath: $.HouseholdMembers.*
      queryMaps:
        - query: UPDATE health.HOUSEHOLD_MEMBER SET lastModifiedBy = ?, lastModifiedTime = ?, clientLastModifiedTime = ?, clientLastModifiedBy = ?, rowVersion = ?, isDeleted = ?, additionalDetails=? WHERE ID = ?;
          basePath: $.HouseholdMembers.*
          jsonMaps:
            - jsonPath: $.HouseholdMembers.*.auditDetails.lastModifiedBy
            - jsonPath: $.HouseholdMembers.*.auditDetails.lastModifiedTime
            - jsonPath: $.HouseholdMembers.*.clientAuditDetails.lastModifiedTime
            - jsonPath: $.HouseholdMembers.*.clientAuditDetails.lastModifiedBy
            - jsonPath: $.HouseholdMembers.*.rowVersion
            - jsonPath: $.HouseholdMembers.*.isDeleted
            - jsonPath: $.HouseholdMembers.*.additionalFields
              type: JSON
              dbType: JSONB
            - jsonPath: $.HouseholdMembers.*.id
