serviceMaps:
  serviceName: works-management-service
  mappings:
    - version: 1.0
      name: works-management-service
      description: Persists report details in job report table
      fromTopic: mukta-wms-payment-report-create
      isTransaction: true
      isAuditEnabled: true
      module: WMS
      objecIdJsonPath: $.id
      tenantIdJsonPath: $.tenantId
      queryMaps:
        - query: INSERT INTO job_report (id, tenant_id, report_number, report_name, no_of_projects, status, request_payload, additional_details, file_store_id, created_by, last_modified_by, created_time, last_modified_time) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?);
          basePath: $.report
          jsonMaps:
            - jsonPath: $.report.id
            - jsonPath: $.report.tenantId
            - jsonPath: $.report.reportNumber
            - jsonPath: $.report.reportName
            - jsonPath: $.report.noOfProjects
            - jsonPath: $.report.status
            - jsonPath: $.report.requestPayload
              type: JSON
              dbType: JSONB
            - jsonPath: $.report.additionalDetails
              type: JSON
              dbType: JSONB
            - jsonPath: $.report.fileStoreId
            - jsonPath: $.report.auditDetails.createdBy
            - jsonPath: $.report.auditDetails.lastModifiedBy
            - jsonPath: $.report.auditDetails.createdTime
            - jsonPath: $.report.auditDetails.lastModifiedTime

    - version: 1.0
      name: works-management-service
      description: Updates report job
      fromTopic: mukta-wms-payment-report-update
      isTransaction: true
      module: WMS
      queryMaps:
        - query: UPDATE job_report SET no_of_projects = ?, status = ?, file_store_id = ?, last_modified_time = ? WHERE id = ?;
          basePath: $.report
          jsonMaps:
            - jsonPath: $.report.noOfProjects
            - jsonPath: $.report.status
            - jsonPath: $.report.fileStoreId
            - jsonPath: $.report.auditDetails.lastModifiedTime
            - jsonPath: $.report.id