ServiceMaps:
  serviceName: measurement-service
  version: 1.0.0
  mappings:
    - topic: enrich-measurement-service-details
      configKey: INDEX
      indexes:
        - name: measurement-service-index
          type: general
          id: $.id,$.tenantId
          jsonPath: $.*
          isBulk: true
          timeStampField: $.auditDetails.createdTime
          customJsonMapping:
            indexMapping: {"Measurements":{"id":"","tenantId":"","measurementNumber":"","physicalRefNumber":"","referenceId":"","entryDate":"","measures":[],"auditDetails":{},"additionalDetails":{}},"contracts":{"id":"","contractNumber":"","supplementNumber":"","versionNumber":"","businessService":"","wfStatus":"","executingAuthority":"","contractType":"","totalContractedAmount":"","securityDeposit":"","agreementDate":"","issueDate":"","defectLiabilityPeriod":"","orgId":"","startDate":"","endDate":"","completionPeriod":"","status":"","lineItems":[],"documents":"","processInstance":"","auditDetails":{},"additionalDetails":{}}}
            fieldMapping:
              - inJsonPath: $.measurements.id
                outJsonPath: $.Measurements.id
              - inJsonPath: $.measurements.tenantId
                outJsonPath: $.Measurements.tenantId
              - inJsonPath: $.measurements.measurementNumber
                outJsonPath: $.Measurements.measurementNumber
              - inJsonPath: $.measurements.physicalRefNumber
                outJsonPath: $.Measurements.physicalRefNumber
              - inJsonPath: $.measurements.referenceId
                outJsonPath: $.Measurements.referenceId
              - inJsonPath: $.measurements.entryDate
                outJsonPath: $.Measurements.entryDate
              - inJsonPath: $.measurements.measures
                outJsonPath: $.Measurements.measures
              - inJsonPath: $.measurements.auditDetails
                outJsonPath: $.Measurements.auditDetails
              - inJsonPath: $.measurements.additionalDetails
                outJsonPath: $.Measurements.additionalDetails
              - inJsonPath: $.contracts.id
                outJsonPath: $.Contracts.id
              - inJsonPath: $.contracts.contractNumber
                outJsonPath: $.Contracts.contractNumber
              - inJsonPath: $.contracts.supplementNumber
                outJsonPath: $.Contracts.supplementNumber
              - inJsonPath: $.contracts.versionNumber
                outJsonPath: $.Contracts.versionNumber
              - inJsonPath: $.contracts.businessService
                outJsonPath: $.Contracts.businessService
              - inJsonPath: $.contracts.wfStatus
                outJsonPath: $.Contracts.wfStatus
              - inJsonPath: $.contracts.executingAuthority
                outJsonPath: $.Contracts.executingAuthority
              - inJsonPath: $.contracts.contractType
                outJsonPath: $.Contracts.contractType
              - inJsonPath: $.contracts.totalContractedAmount
                outJsonPath: $.Contracts.totalContractedAmount
              - inJsonPath: $.contracts.securityDeposit
                outJsonPath: $.Contracts.securityDeposit
              - inJsonPath: $.contracts.agreementDate
                outJsonPath: $.Contracts.agreementDate
              - inJsonPath: $.contracts.issueDate
                outJsonPath: $.Contracts.issueDate
              - inJsonPath: $.contracts.defectLiabilityPeriod
                outJsonPath: $.Contracts.defectLiabilityPeriod
              - inJsonPath: $.contracts.orgId
                outJsonPath: $.Contracts.orgId
              - inJsonPath: $.contracts.startDate
                outJsonPath: $.Contracts.startDate
              - inJsonPath: $.contracts.endDate
                outJsonPath: $.Contracts.endDate
              - inJsonPath: $.contracts.completionPeriod
                outJsonPath: $.Contracts.completionPeriod
              - inJsonPath: $.contracts.status
                outJsonPath: $.Contracts.status
              - inJsonPath: $.contracts.lineItems
                outJsonPath: $.Contracts.lineItems
              - inJsonPath: $.contracts.documents
                outJsonPath: $.Contracts.documents
              - inJsonPath: $.contracts.processInstance
                outJsonPath: $.Contracts.processInstance
              - inJsonPath: $.contracts.auditDetails
                outJsonPath: $.Contracts.auditDetails
              - inJsonPath: $.contracts.additionalDetails
                outJsonPath: $.Contracts.additionalDetails


            externalUriMapping:
              - path: http://egov-workflow-v2.egov:8080/egov-workflow-v2/egov-wf/process/_search
                queryParam: businessIds=$.measurementNumber,history=true,tenantId=$.tenantId
                apiRequest: { "RequestInfo": { "apiId": "org.egov.bill","ver": "1.0","ts": 1502890899493,"action": "asd","did": "4354648646","key": "xyz","msgId": "654654","requesterId": "61","authToken": "d9994555-7656-4a67-ab3a-a952a0d4dfc8","userInfo": { "id": 1,"uuid": "1fec8102-0e02-4d0a-b283-cd80d5dab067","type": "EMPLOYEE","tenantId": "pg.citya","roles": [ { "name": "Employee","code": "EMPLOYEE","tenantId": "pg.citya" } ] } } }
                uriResponseMapping:
                  - inJsonPath: $.ProcessInstances
                    outJsonPath: $.Measurements.history
                  - inJsonPath: $.ProcessInstances[0]
                    outJsonPath: $.Measurements.currentProcessInstance




